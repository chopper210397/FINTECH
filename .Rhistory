cred_seg3 %>% ggplot(aes(x=fecha,y=seguro_monto))+geom_line()
cred_seg3 %>% ggplot(aes(x=fecha,y=creditdisbursement_amount))+geom_line()
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(y=creditdisbursement_amount)
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=creditdisbursement_amount))
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=creditdisbursement_amount))+
geom_line(aes(y=credit_amount))
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=creditdisbursement_amount),colour="red")+
geom_line(aes(y=credit_amount),colour="blue")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=seguro_monto),colour="blue")+
geom_line(aes(y=fgatotal),colour="red")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=seguro_monto),colour="blue")+
geom_line(aes(y=fgatotal),colour="red")+labs(title = "seguros y fondo de garantia")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=seguro_monto),colour="blue")+
geom_line(aes(y=fgatotal),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=seguro_monto),colour="blue")+
geom_line(aes(y=fgatotal),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=insurance")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=seguro_monto),colour="blue")+
geom_line(aes(y=fgatotal),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=seguro_monto),colour="blue")+
geom_line(aes(y=fgatotal),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=seguro_monto),colour="blue")+
geom_line(aes(y=fgatotal),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000),colour="blue")+
geom_line(aes(y=fgatotal),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000),colour="blue")+
geom_line(aes(y=(fgatotal)/1000),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000),colour="blue")+
geom_line(aes(y=(fgatotal)/1000),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/10000000),colour="blue")+
geom_line(aes(y=(fgatotal)/100000000),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000),colour="blue")+
geom_line(aes(y=(fgatotal)/100000000),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000),colour="blue")+
geom_line(aes(y=(fgatotal)/1000),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue")+
geom_line(aes(y=(fgatotal)/1000000),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/100000),colour="blue")+
geom_line(aes(y=(fgatotal)/100000),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue")+
geom_line(aes(y=(fgatotal)/1000000),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue")+
geom_line(aes(y=(fgatotal)/1000000),colour="red")+labs(title = "seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue")+
geom_line(aes(y=(fgatotal)/1000000),colour="red")+labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=creditdisbursement_amount),colour="red")+
geom_line(aes(y=credit_amount),colour="blue")
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=creditdisbursement_amount),colour="red")+
geom_line(aes(y=credit_amount),colour="blue")+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=(creditdisbursement_amount)/1000000),colour="red")+
geom_line(aes(y=(credit_amount)/1000000),colour="blue")+
labs(title = "suma de credito total y credito desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=(creditdisbursement_amount)/1000000),colour="red")+
geom_line(aes(y=(credit_amount)/1000000),colour="blue")+
labs(title = "suma de credito total y credito desembolsado por mes",
caption = "Rojo=credito desembolsado, azul=credito total",x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha,y=interesanual))+geom_line()
cred_seg3 %>% ggplot(aes(x=fecha,y=interesanual))+geom_line()+
labs(title = "tasa de interés anual promedio",
caption = "Rojo=credito desembolsado, azul=credito total",
x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha,y=interesanual))+geom_line()+
labs(title = "tasa de interés anual promedio",
caption = "",
x="",y="promedio por mes")
cred_seg3 %>% ggplot(aes(x=fecha,y=interesanual))+geom_line(colour="blue")+
labs(title = "tasa de interés anual promedio",
caption = "",
x="",y="promedio por mes")
cred_seg3 %>% ggplot(aes(x=fecha,y=interesanual))+geom_line(colour="blue",size=2)+
labs(title = "tasa de interés anual promedio",
caption = "",
x="",y="promedio por mes")
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=(creditdisbursement_amount)/1000000),colour="red")+
geom_line(aes(y=(credit_amount)/1000000),colour="blue")+
labs(title = "suma de credito total y credito desembolsado por mes",
caption = "Rojo=credito desembolsado, azul=credito total",
x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=(creditdisbursement_amount)/1000000),colour="red",size=1.5)+
geom_line(aes(y=(credit_amount)/1000000),colour="blue")+
labs(title = "suma de credito total y credito desembolsado por mes",
caption = "Rojo=credito desembolsado, azul=credito total",
x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=(creditdisbursement_amount)/1000000),colour="red",size=1.5)+
geom_line(aes(y=(credit_amount)/1000000),colour="blue",size=1.5)+
labs(title = "suma de credito total y credito desembolsado por mes",
caption = "Rojo=credito desembolsado, azul=credito total",
x="",y="en millones")
# graficando
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue")+
geom_line(aes(y=(fgatotal)/1000000),colour="red")+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
# graficando
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue",size=1.5)+
geom_line(aes(y=(fgatotal)/1000000),colour="red",size=1.5)+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
# graficando
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue",size=1.5)+
geom_line(aes(y=(fgatotal)/1000000),colour="red",size=1.5)+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=(creditdisbursement_amount)/1000000),colour="red",size=1.5)+
geom_line(aes(y=(credit_amount)/1000000),colour="blue",size=1.5)+
labs(title = "suma de credito total y credito desembolsado por mes",
caption = "Rojo=credito desembolsado, azul=credito total",
x="",y="en millones")
# graficando
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue",size=1.5)+
geom_line(aes(y=(fgatotal)/1000000),colour="red",size=1.5)+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
cred_seg3
#-------- 2022 ---------#
cred_seg3 %>% filter(fecha>=2022-01-01)
#-------- 2022 ---------#
cred_seg3 %>% filter(fecha>="2022-01-01")
#-------- 2022 ---------#
cred_seg3 %>% filter(fecha>="2022-01-01") %>% ggplot(aes(x=fecha,y=credit_amount))
#-------- 2022 ---------#
cred_seg3 %>% filter(fecha>="2022-01-01") %>% ggplot(aes(x=fecha,y=credit_amount))+geom_line()
#-------- 2022 ---------#
cred_seg2 %>% filter(fecha>="2022-01-01") %>% ggplot(aes(x=fecha,y=credit_amount))+geom_line()
#-------- 2022 ---------#
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>% ggplot(aes(x=fecha,y=credit_amount))+geom_line()
#-------- 2022 ---------#
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>% ggplot(aes(x=`Disbursement Date`,y=credit_amount))+geom_line()
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(y=credit_amount)
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=credit_amount))
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=credit_amount))+geom_line(color="red")
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=credit_amount))+geom_line(aes(y=creditbursement_amount))
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=credit_amount))+geom_line(aes(y=creditdisbursement_amount))
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=credit_amount),color="red")+geom_line(aes(y=creditdisbursement_amount))
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=credit_amount),color="red")+geom_line(aes(y=creditdisbursement_amount),color="blue")
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=credit_amount),color="red",size=1.3)+geom_line(aes(y=creditdisbursement_amount),color="blue")
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=credit_amount),color="red",size=1.2)+
geom_line(aes(y=creditdisbursement_amount),color="blue",size=1.2)
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=(credit_amount)/1000),color="red",size=1.2)+
geom_line(aes(y=creditdisbursement_amount),color="blue",size=1.2)
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=(credit_amount)/1000),color="red",size=1.2)+
geom_line(aes(y=(creditdisbursement_amount)/1000),color="blue",size=1.2)
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=(credit_amount)/1000),color="red",size=1.2)+
geom_line(aes(y=(creditdisbursement_amount)/1000),color="blue",size=1.2)+
labs(title = "2022- credito total y desembolso de credito",
caption = "",
x="",y="promedio por mes")
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=(credit_amount)/1000),color="red",size=1.2)+
geom_line(aes(y=(creditdisbursement_amount)/1000),color="blue",size=1.2)+
labs(title = "2022- credito total y desembolso de credito",
caption = "Rojo= credito total, Azul= Credito desembolsado",
x="",y="promedio por mes")
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=(credit_amount)/1000),color="red",size=1.2)+
geom_line(aes(y=(creditdisbursement_amount)/1000),color="blue",size=1.2)+
labs(title = "2022- credito total y desembolso de credito",
caption = "Rojo= credito total, Azul= Credito desembolsado",
x="",y="en miles")
cred_seg2 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue",size=1.5)+
geom_line(aes(y=(fgatotal)/1000000),colour="red",size=1.5)+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
cred_seg2 %>% ggplot(aes(x=`Disbursement Date`))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue",size=1.5)+
geom_line(aes(y=(fgatotal)/1000000),colour="red",size=1.5)+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
cred_seg2 %>% ggplot(aes(x=`Disbursement Date`))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue",size=1)+
geom_line(aes(y=(fgatotal)/1000000),colour="red",size=1)+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
library(readr)
library(readxl)
library(lubridate)
library(dplyr)
library(ggplot2)
library(tidyr)
# todos los estados de solicitud incluidos
creditos3  %>% ggplot(aes(x=`fecha actualizacion`,y=n))+
geom_line()+facet_wrap(.~`estado solicitud`)
# abandonado
creditos3 %>% filter(`estado solicitud`%in% c("Abandonado")) %>% ggplot(aes(x=`fecha actualizacion`,y=n))+
geom_line()+facet_wrap(.~`estado solicitud`)
# grid por estado solicitud desde 2021 para la data mas larga
creditos3 %>% filter(`estado solicitud`%in% c("Aprobado","Denegado","Retirado","Vencido")) %>% ggplot(aes(x=`fecha actualizacion`,y=n))+
geom_line()+facet_grid(.~`estado solicitud`)
# grid por estado solicitud desde 2021 para la data mas larga
creditos3 %>% filter(`estado solicitud`%in% c("En proceso")) %>% ggplot(aes(x=`fecha actualizacion`,y=n))+
geom_line()+facet_grid(.~`estado solicitud`)
# grid por estado solicitud desde 2021 para la data mas larga
creditos3 %>% filter(`estado solicitud`%in% c("Aprobado")) %>% ggplot(aes(x=`fecha actualizacion`,y=n))+
geom_line()+facet_grid(.~`estado solicitud`)
# numero de aprobados, desaprobados, etc por estado solicitud desde 2021 a actualidad
creditos2022<-creditos %>% filter(`fecha actualizacion`>"2022-01-01") %>%  count(`fecha actualizacion`,`estado solicitud`) %>%
arrange(`fecha actualizacion`)
# todos los estados de solicitud incluidos
creditos2022  %>% ggplot(aes(x=`fecha actualizacion`,y=n))+
geom_line()+facet_wrap(.~`estado solicitud`)
# abandonado
creditos2022 %>% filter(`estado solicitud`%in% c("Abandonado")) %>% ggplot(aes(x=`fecha actualizacion`,y=n))+
geom_line()+facet_wrap(.~`estado solicitud`)
# grid por estado solicitud desde 2021 para la data mas larga
creditos2022 %>% filter(`estado solicitud`%in% c("Aprobado","Denegado","Retirado","Vencido")) %>% ggplot(aes(x=`fecha actualizacion`,y=n))+
geom_line()+facet_grid(.~`estado solicitud`)
# grid por estado solicitud desde 2021 para la data mas larga
creditos2022 %>% filter(`estado solicitud`%in% c("En proceso")) %>% ggplot(aes(x=`fecha actualizacion`,y=n))+
geom_line()+facet_grid(.~`estado solicitud`)
# grid por estado solicitud desde 2021 para la data mas larga
creditos2022 %>% filter(`estado solicitud`%in% c("Aprobado")) %>% ggplot(aes(x=`fecha actualizacion`,y=n))+
geom_line()+facet_grid(.~`estado solicitud`)
# scatterplot
cred_seg %>% ggplot(aes(x=`Total Insurance Amount`,y=(`Credit Disbursement Amount`)/1000)) +
geom_point(color="blue")+coord_flip()
cred_seg %>% ggplot(aes(x=`Total Fga Amount`,y=(`Credit Disbursement Amount`)/1000)) +
geom_point(color="blue")+coord_flip()
cred_seg %>% ggplot(aes(x=`Total Fga Amount`,y=(`Credit Disbursement Amount`)/1000)) +
geom_bin2d(color="blue")+coord_flip()
cred_seg %>% ggplot(aes(x=`Total Insurance Amount`,y=(`Credit Disbursement Amount`)/1000)) +
geom_bin2d(color="blue")+coord_flip()
cred_seg %>% ggplot(aes(x=`Total Fga Amount`,y=(`Credit Disbursement Amount`)/1000)) +
geom_bin2d(color="blue")+coord_flip()
# histograms
cred_seg  %>% ggplot(aes(x=(`Credit Disbursement Amount`)/1000))+geom_histogram(color="darkblue", fill="lightblue")
cred_seg  %>% ggplot(aes(x=(`Credit Amount`)/1000))+geom_histogram(color="darkblue", fill="lightblue")
cred_seg  %>% ggplot(aes(x=`Annual Interest`))+geom_histogram(color="darkblue", fill="lightblue")
# scatterplot
cred_seg %>% ggplot(aes(x=`Total Insurance Amount`,y=(`Credit Disbursement Amount`)/1000)) +
geom_point(color="blue")+coord_flip()
cred_seg %>% ggplot(aes(x=`Total Fga Amount`,y=(`Credit Disbursement Amount`)/1000)) +
geom_point(color="blue")+coord_flip()
# graph lines
cred_seg2<-cred_seg %>% group_by(`Disbursement Date`) %>%
summarise(creditdisbursement_amount=sum(`Credit Disbursement Amount`),credit_amount=sum(`Credit Amount`),
interesanual=mean(`Annual Interest`), pagototal=sum(`Total Payment`),
fgatotal=sum(`Total Fga Amount`), seguro_monto=sum(`Total Insurance Amount`))
cred_seg2 %>% ggplot(aes(x=`Disbursement Date`))+
geom_line(aes(y=cred_seg2$seguro_monto),colour="blue")+
geom_line(aes(y=cred_seg2$fgatotal),colour="red")
# graph lines
cred_seg2<-cred_seg %>% group_by(`Disbursement Date`) %>%
summarise(creditdisbursement_amount=sum(`Credit Disbursement Amount`),credit_amount=sum(`Credit Amount`),
interesanual=mean(`Annual Interest`), pagototal=sum(`Total Payment`),
fgatotal=sum(`Total Fga Amount`), seguro_monto=sum(`Total Insurance Amount`))
cred_seg2 %>% ggplot(aes(x=`Disbursement Date`))+
geom_line(aes(y=cred_seg2$seguro_monto),colour="blue")+
geom_line(aes(y=cred_seg2$fgatotal),colour="red")
cred_seg3<-cred_seg3 %>% group_by(format(as.Date(cred_seg3$`Disbursement Date`), "%Y-%m")) %>%
summarise(creditdisbursement_amount=sum(creditdisbursement_amount),
credit_amount=sum(credit_amount), interesanual=mean(interesanual), pagototal=sum(pagototal),
fgatotal=sum(fgatotal), seguro_monto=sum(seguro_monto))
cred_seg3<-cred_seg3 %>% group_by(format(as.Date(cred_seg3$`Disbursement Date`), "%Y-%m")) %>%
summarise(creditdisbursement_amount=sum(creditdisbursement_amount),
credit_amount=sum(credit_amount), interesanual=mean(interesanual), pagototal=sum(pagototal),
fgatotal=sum(fgatotal), seguro_monto=sum(seguro_monto))
# graficando
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue",size=1.5)+
geom_line(aes(y=(fgatotal)/1000000),colour="red",size=1.5)+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
# graficando
cred_seg3 %>% ggplot(aes(x=fecha))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue",size=1.5)+
geom_line(aes(y=(fgatotal)/1000000),colour="red",size=1.5)+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha))+geom_line(aes(y=(creditdisbursement_amount)/1000000),colour="red",size=1.5)+
geom_line(aes(y=(credit_amount)/1000000),colour="blue",size=1.5)+
labs(title = "suma de credito total y credito desembolsado por mes",
caption = "Rojo=credito desembolsado, azul=credito total",
x="",y="en millones")
cred_seg3 %>% ggplot(aes(x=fecha,y=interesanual))+geom_line(colour="blue",size=2)+
labs(title = "tasa de interés anual promedio",
caption = "",
x="",y="promedio por mes")
#-------- 2022 ---------#
# lo evaluamos por día
cred_seg2 %>% filter(`Disbursement Date`>="2022-01-01") %>%
ggplot(aes(x=`Disbursement Date`))+geom_line(aes(y=(credit_amount)/1000),color="red",size=1.2)+
geom_line(aes(y=(creditdisbursement_amount)/1000),color="blue",size=1.2)+
labs(title = "2022- credito total y desembolso de credito",
caption = "Rojo= credito total, Azul= Credito desembolsado",
x="",y="en miles")
cred_seg2 %>% ggplot(aes(x=`Disbursement Date`))+
geom_line(aes(y=(seguro_monto)/1000000),colour="blue",size=1)+
geom_line(aes(y=(fgatotal)/1000000),colour="red",size=1)+
labs(title = "suma de seguros y fondo de garantia desembolsado por mes",
caption = "Rojo=fga, azul=seguro",x="",y="en millones")
lm(data = cred_seg2)
lm(creditdisbursement_amount~interesanual+fgatotal+seguro_monto  data = cred_seg2)
lm(creditdisbursement_amount~interesanual+fgatotal+seguro_monto,  data = cred_seg2)
summary( lm(creditdisbursement_amount~interesanual+fgatotal+seguro_monto,  data = cred_seg2) )
llamadas<-read_xlsx("voxinplan.xlsx")
View(llamadas)
str(llamadas)
View(llamadas)
llamadas<-read_xlsx("voximplant.xlsx")
str(llamadas)
hist(llamadas$`Is incoming`)
hist(llamadas$`Date of call start`)
hist(llamadas$`Call duration`)
as.numeric(llamadas$`Call duration`)
llamadas$`Call duration`<-as.numeric(llamadas$`Call duration`)
hist(llamadas$`Call duration`)
boxplot(llamadas$`Call duration`)
hist(llamadas$`Call duration`)
hist(llamadas$`Call cost`)
llamadas$`Call cost`<-as.numeric(llamadas$`Call cost`)
hist(llamadas$`Call cost`)
hist(llamadas$`Call cost`)
as.numeric(llamadas$`Call cost`)
llamadas<-read_xlsx("voximplant.xlsx")
str(llamadas)
library(readr)
library(readxl)
library(lubridate)
library(dplyr)
library(ggplot2)
library(tidyr)
llamadas<-read_xlsx("voximplant.xlsx")
str(llamadas)
View(llamadas)
str(llamadas)
unique(llamadas$`Date of call start`)
llamadas$`Date of call start`<-as.Date(llamadas$`Date of call start`)
llamadas<-llamadas %>% mutate(mes=month(`Date of call start`))
unique(llamadas$`Agent B`)
unique(llamadas$`Agent A`)
llamadas$`Call duration`<-as.numeric(llamadas$`Call duration`)
llamadas$`Call cost`<-as.numeric(llamadas$`Call cost`)
hist(llamadas$`Call duration`)
hist(llamadas$`Call cost`)
a<-llamadas %>% filter(mes=="3" & `Call duration`!="0") %>%  group_by(`Agent A`)%>%  count(`Is incoming`)
a %>% ggplot(aes(x=reorder(`Agent A`,n),y=n))+
geom_bar(stat = "identity",fill="lightblue")+coord_flip()+facet_grid(.~`Is incoming`)
View(a)
View(llamadas)
day(llamadas$`Date of call start`)
llamadas<-read_xlsx("voximplant.xlsx")
str(llamadas)
unique(llamadas$`Date of call start`)
llamadas$`Date of call start`<-as.Date(llamadas$`Date of call start`)
llamadas<-llamadas %>% mutate(mes=month(`Date of call start`))
unique(llamadas$`Agent B`)
unique(llamadas$`Agent A`)
llamadas$`Call duration`<-as.numeric(llamadas$`Call duration`)
llamadas$`Call cost`<-as.numeric(llamadas$`Call cost`)
day(llamadas$`Date of call start`)
hist(llamadas$`Call duration`)
hist(llamadas$`Call cost`)
View(llamadas)
unique(month(llamadas$`Date of call start`))
unique(day(llamadas$`Date of call start`))
# solo dia
llamadas<-llamadas %>% mutate(dia=day(`Date of call start`))
b<-llamadas %>% filter(dia=="25" & `Call duration`!="0") %>%  group_by(`Agent A`)%>%  count(`Is incoming`)
a %>% ggplot(aes(x=reorder(`Agent A`,n),y=n))+
geom_bar(stat = "identity",fill="lightblue")+coord_flip()+facet_grid(.~`Is incoming`)
View(b)
b %>% ggplot(aes(x=reorder(`Agent A`,n),y=n))+
geom_bar(stat = "identity",fill="lightblue")+coord_flip()+facet_grid(.~`Is incoming`)
str(llamadas)
# reporte comercial aflore
library(readr)
library(readxl)
library(lubridate)
library(dplyr)
library(ggplot2)
library(tidyr)
vinculado<-read_xlsx("consejerovinculado.xlsx",sheet = "data",
col_types = c("numeric","numeric","text","numeric","text","numeric","text","text","text","numeric","text"))
str(vinculado)
View(vinculado)
unique(vinculado$`Fecha de vinculacion`)
zonas<-unique(vinculado$Zona)
zonas<-data.frame(zonas)
zonas<-zonas %>% arrange(zonas)
# damos formato a la fecha
vinculado$`Fecha de vinculacion`<-as.Date(vinculado$`Fecha de vinculacion`, format = "%d/%m/%Y")
vinculado %>% ggplot(aes(x= Coordinador))+geom_bar()+coord_flip()
# coordinador por perfil
vinculado %>% filter(Coordinador!="NA")%>% filter(Perfil!="NA") %>% ggplot(aes(x=Coordinador,y=Constante,fill=Perfil))+geom_bar(stat = "identity")+coord_flip()+theme_minimal()
str(vinculado)
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Zona))+geom_point()
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=`Nombre consejero`))+geom_point()
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+geom_point()
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+geom_point(aes(size=Zona,fill=Perfil))
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+geom_point(aes(size=`Días de vinculación`,fill=Perfil))
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+geom_point(aes(fill=Perfil))
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+geom_point(aes(size=Perfil))
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+geom_point(aes(color=Perfil))
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+geom_bar(aes(color=Perfil))
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+geom_bar(stat="identity",aes(color=Perfil))
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+geom_bar(stat="identity",aes(fill=Perfil))
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Perfil))+geom_bar(stat="identity",aes(fill=Coordinador))
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Perfil))+geom_bar(stat="identity",aes(fill=Coordinador),position = "dodge2")
#
vinculado %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+
geom_bar(stat="identity",aes(fill=Perfil),position = "dodge2")
#
vinculado %>%filter(Coordinador!="NA")%>% filter(Perfil!="NA") %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+
geom_bar(stat="identity",aes(fill=Perfil),position = "dodge2")
#
vinculado %>%filter(Coordinador!="NA")%>% filter(Perfil!="NA") %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+
geom_bar(stat="identity",position = "dodge2")
#
vinculado %>%filter(Coordinador!="NA")%>% filter(Perfil!="NA") %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+
geom_bar(stat="identity",aes(fill=Perfil),position = "dodge2")
#
vinculado %>%filter(Coordinador!="NA")%>% filter(Perfil!="NA") %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+
geom_bar(stat="identity",aes(color=Perfil),position = "dodge2")
#
vinculado %>%filter(Coordinador!="NA")%>% filter(Perfil!="NA") %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+
geom_bar(stat="identity",aes(fill=Perfil),position = "dodge2")
#
vinculado %>%filter(Coordinador!="NA")%>% filter(Perfil!="NA") %>% ggplot(aes(x=`Días de vinculación`,y=Coordinador))+
geom_bar(stat="identity",aes(fill=Perfil))
