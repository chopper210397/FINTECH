mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(-dia)
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=76) %>% summarise(promedio=mean(dia))
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=73) %>% summarise(promedio=mean(dia))
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Natalia Piedrahita" | Owner=="Natalia Piedrahita" )  %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=day(`Closed at`)-day(`Created at`)) %>%
select(dia) %>% na.omit()%>% arrange(dia)  %>% slice_head(n=70) %>%  summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Natalia Piedrahita" | Owner=="Natalia Piedrahita" )  %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=day(`Closed at`)-day(`Created at`)) %>%
select(dia) %>% na.omit()%>% arrange(dia)  %>%  summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Natalia Piedrahita" | Owner=="Natalia Piedrahita" )  %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=day(`Closed at`)-day(`Created at`)) %>%
select(dia) %>% na.omit()%>% arrange(dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=100) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(-dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`)))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`)))%>% arrange(-dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`)))%>% arrange(-dia)
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(-dia)  %>% slice_head(n=100) %>% summarise(promedio=mean(dia))
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(-dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(-dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))
rm(tickets)
install.packages("tm")
?gmailr
install.packages("gmailr")
library(gmailr)
gm_threads(num_results = 10)
gm_auth_configure(path = "/home/luis/Descargas/client_secret_299160033159-29v8olcidpimcqo62ac2dbpa41ur76n4.apps.googleusercontent.com.json")
gm_threads(num_results = 10)
use_secret_file("DoMoreWithR.json")
gm_auth_configure(path = "DoMoreWithR.json")
gm_auth_configure(path = "DoMoreWithR.json")
library(gmailr)
gm_auth_configure(path = "DoMoreWithR.json")
gm_auth_configure(path = "DoMoreWithR.json")
gm_auth(path = "DoMoreWithR.json")
gm_threads(num_results = 10)
gm_threads(num_results = 10)
gm_threads(num_results = 10)
a<-gm_threads(num_results = 10)
View(a)
gm_thread(gm_id(my_threads)[[1]])
rm(a)
gm_thread(gm_id(my_threads)[[1]])
my_threads<-gm_threads(num_results = 10)
gm_thread(gm_id(my_threads)[[1]])
latest_thread <- gm_thread(gm_id(my_threads)[[1]])
latest_thread$messages
latest_thread <- gm_thread(gm_id(my_threads)[[2]])
latest_thread$messages
my_drafts = gm_drafts()
View(my_drafts)
my_history = history(start_num)
my_threads<-gm_threads(num_results = 10)
gm_threads(num_results = 10)
library(readxl)
library(lubridate)
library(dplyr)
tickets<-read_xls("tickets_julio.xls",skip = 2)
tickets<-read_xls("tickets_julio.xls",skip = 2)
tickets$`Closed at`<-as.Date( tickets$`Closed at`)
tickets$`Created at`<-as.Date( tickets$`Created at`)
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==6) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))  # el slice head lo use
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))  # el slice head lo use
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia) %>% summarise(promedio=mean(dia))  # el slice head lo use
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))  # el slice head lo use
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia) %>% summarise(promedio=mean(dia))  # el slice head lo use
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))  # el slice head lo use
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit()  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))  # el slice head lo use
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))  # el slice head lo use
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))  # el slice head lo use
tickets<-read_xls("tickets_julio.xls",skip = 2)
tickets$`Closed at`<-as.Date( tickets$`Closed at`)
tickets$`Created at`<-as.Date( tickets$`Created at`)
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))  # el slice head lo use
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)   %>% summarise(promedio=mean(dia))  # el slice head lo use
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(-dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=60) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=100) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=90) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=80) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(-dia)
a<-tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(-dia)
View(a)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=70) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=61) %>% summarise(promedio=mean(dia))
View(a)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=65) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=65)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=65) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% filter(dia<8) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=64) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=60) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=66) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% filter(dia<8) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=67) %>% summarise(promedio=mean(dia))
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=67) %>% summarise(promedio=mean(dia))
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=67) %>% summarise(promedio=mean(dia))  # el slice head lo use
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==7) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% filter(dia<6) %>% summarise(promedio=mean(dia))
library(tidyverse)
install.packages("tidyverse")
install.packages("tidytext")
library(tidytext)
library(tidyverse)
library(readxl)
read_xlsx("JPT.xlsx")
read_xlsx("JTP.xlsx")
jtp<-read_xlsx("JTP.xlsx")
jtp %>% distinct()
View(jtp)
jtp<-read_xls("JTP.xlsx")
jtp<-read_xlsx("JTP.xlsx")
jtp<-read_excel("JTP.xlsx")
read_excel("JTP.xlsx")
jtp<-read_excel("jtp.xls")
jtp %>% ungroup()
jtp %>%mutate(linea=row_number()) %>%  ungroup()
jtp  %>%  ungroup()
jtp  %>%  ungroup() %>% unnest_tokens()
jtp  %>%  ungroup() %>% unnest_tokens(`Comentario IA sobre alianza`)
jtp   %>% unnest_tokens(`Comentario IA sobre alianza`)
jtp   %>% unnest_tokens(word,`Comentario IA sobre alianza`)
ia_token<-jtp   %>% unnest_tokens(word,`Comentario IA sobre alianza`)
View(ia_token)
ia_token<-jtp   %>% unnest_tokens(word)
ia_token<-jtp   %>% unnest_tokens(word,`Comentario IA sobre alianza`)
View(ia_token)
View(ia_token)
View(ia_token)
ia_token<-jtp   %>% unnest_tokens(word,`Comentario IA sobre alianza`) %>% select(word)
stopwords_es <- read.csv("https://bitsandbricks.github.io/data/stopwords_es.csv",
stringsAsFactors = FALSE)
ia_token %>% anti_join(stopwords_es,by=c("word"="STOPWORD"))
ia_tokenizado<-ia_token %>% anti_join(stopwords_es,by=c("word"="STOPWORD"))
ia_tokenizado %>%
count(word, sort = TRUE)
a<-ia_tokenizado %>%
count(word, sort = TRUE)
View(a)
jtp %>% count()
jtp %>% count(`Comentario IA sobre alianza`,sort = TRUE)
# clientes
client_token<-jtp   %>% unnest_tokens(word,`Comentario Cliente sobre alianza`) %>% select(word)
# clientes
client_token<-jtp   %>% unnest_tokens(word,`Comentario Cliente sobre alianza`) %>% select(word)
client_tokenizado<-client_token %>% anti_join(stopwords_es,by=c("word"="STOPWORD"))
b<-client_tokenizado %>%
count(word, sort = TRUE)
View(b)
jtp %>% count(`Comentario Cliente sobre alianza`,sort = TRUE)
jtp %>% count(`Comentario IA sobre alianza`,sort = TRUE)
jtp %>% count(`Comentario Cliente sobre alianza`,sort = TRUE)
as<-jtp %>% count(`Comentario IA sobre alianza`,sort = TRUE)
bs<-jtp %>% count(`Comentario Cliente sobre alianza`,sort = TRUE)
library(writexl)
write_xlsx(as)
write_xlsx(as,"as.xlsx")
bs<-jtp %>% count(`Comentario Cliente sobre alianza`,sort = TRUE)
write_xlsx(bs,"bs.xlsx")
library(readxl)
library(lubridate)
library(dplyr)
tickets<-read_xls("tickets_agosto.xls",skip = 2)
tickets<-read_xls("tickets_agosto.xls",skip = 2)
tickets$`Closed at`<-as.Date( tickets$`Closed at`)
tickets$`Created at`<-as.Date( tickets$`Created at`)
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)  %>% slice_head(n=67) %>% summarise(promedio=mean(dia))  # el slice head lo use
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)   %>% summarise(promedio=mean(dia))  # el slice head lo use
tickets<-read_xls("tickets_agosto.xls",skip = 2)
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)   %>% summarise(promedio=mean(dia))  # el slice head lo use
# siempre se debe cambiar el numero del month(closed at) al mes que deseamos evaluar
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)   %>% summarise(promedio=mean(dia))                      # el slice head lo use
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>%
select(dia) %>% na.omit() %>% arrange(-dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia)
a<-tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia)
View(a)
a<-tickets %>% filter(Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia)
a<-tickets %>% filter(Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia>=2)
a<-tickets %>% filter(Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia>1)
tickets %>% filter(Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia>1) %>% select(`#`)
tickets %>% filter(Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia<2) %>% select(`#`)
tickets %>% filter(Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia<2)
a<-tickets %>% filter(Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia<2)
tickets %>% filter(Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia<2) %>% select(`#`)
tickets %>% filter(Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia<2) %>% group_by(State,dia)
tickets %>% filter(Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia<2) %>% count(State,dia)
tickets %>% filter(Customer=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia<2) %>% count(State,dia)
tickets %>% filter(Customer=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% filter(dia>=2) %>% count(State,dia)
tickets %>% filter(Customer=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia) %>% count(State,dia)
tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia)
a<-tickets %>% filter(Customer=="Luisa Moreno" | Owner=="Luisa Moreno" ) %>% filter(!is.na(`Closed at`)) %>%
filter(month(`Closed at`)==8) %>%
mutate(dia=(day(`Closed at`)-day(`Created at`))) %>% arrange(-dia)
library(readxl)
read_xlsx("seguimiento info.xlsx",sheet = "PQRs info@aflore.co")
read_xlsx("seguimiento_info.xlsx",sheet = "PQRs info@aflore.co")
library(readxl)
read_xlsx("seguimiento_info.xlsx",sheet = "PQRs info@aflore.co")
read_xlsx("seguimiento_info .xlsx",sheet = "PQRs info@aflore.co")
read_xlsx("seguimiento_info.xlsx",sheet = "PQRs info@aflore.co")
data<-read_xlsx("seguimiento_info.xlsx",sheet = "PQRs info@aflore.co")
data<-read_xlsx("seguimiento_info.xlsx",sheet = "PQRs info@aflore.co")
unique(data$fecha)
unique(data$Estado)
unique(data$`Área encargada`)
library(dplyr)
unique(data$`Área encargada`) %>% arrange()
list( unique(data$`Área encargada`)) %>% arrange()
as.data.frame( unique(data$`Área encargada`)) %>% arrange()
as.data.frame( unique(data$`Área encargada`)) %>% arrange(data)
as.data.frame( unique(data$`Área encargada`)) %>% arrange()
a<- unique(data$`Área encargada`)
a %>% arrange()
as.data.frame(a)
a<-as.data.frame(a)
a %>% arrange()
View(a)
a %>% arrange(a)
a<-a %>% arrange(a)
View(a)
tolower(a)
tolower(a$a)
unique( tolower(a$a) )
a<- tolower( unique(data$`Área encargada`))
a<-as.data.frame(a)
a<-a %>% arrange(a)
View(a)
a<-a %>% arrange(a) %>% distinct()
View(a)
a
View(a)
data$`¿Qué se registra?`
unique(data$`¿Qué se registra?`
unique(data$`¿Qué se registra?`)
unique(data$`¿Qué se registra?`)
a<- tolower( unique(data$`¿Qué se registra?`))
a<-as.data.frame(a)
a<-a %>% arrange(a) %>% distinct()
a
a<- tolower( unique(data$`Tipo de PQR`))
a<-as.data.frame(a)
a<-a %>% arrange(a) %>% distinct()
a
a<- tolower( unique(data$`Es Cliente o Consejero?`))
a<-as.data.frame(a)
a<-a %>% arrange(a) %>% distinct()
a
a<- tolower( unique(data$`Medio de respuesta`))
a<-as.data.frame(a)
a<-a %>% arrange(a) %>% distinct()
a
