selected_data<-last_7_days %>%
drop_na(`Si quieres que te contactemos para profundizar sobre tu calificación, ¡déjanos tu número de celular porfa! (Opcional) - Sin espacios, sin símbolos ni +57`) %>%
arrange(across(Timestamp,desc))
#ss <- gs4_create("wish_contact_last_7_days", sheets = selected_data)
sheet_write(selected_data,ss="https://docs.google.com/spreadsheets/d/1CNdsejB5HRBYDAj6pajzfpjE60_BBSf2uA_KRWAkJPc/edit?usp=sharing",sheet="selected_data")
rm(list=ls())
install.packages("rJava")
library(tidyr)
library(gmailr)
library(googlesheets4)
library(dplyr)
library(lubridate)
library(tidyr)
library(tidyr)
library(gmailr)
luis_barrios<-range_read("https://docs.google.com/spreadsheets/d/1QNXBhd_MWTbQFaYo_tw0O2WIWA1mzLNb8ZhyvjdEXcs/edit?usp=sharing",sheet = "Luis Barrios",
col_types = "Dcccccc")
# sheet Planes de acción
luis_barrios<-range_read("https://docs.google.com/spreadsheets/d/1QNXBhd_MWTbQFaYo_tw0O2WIWA1mzLNb8ZhyvjdEXcs/edit?usp=sharing",sheet = "Luis Barrios",
col_types = "Dcccccc")
# sheet Planes de acción
luis_barrios<-range_read("https://docs.google.com/spreadsheets/d/1QNXBhd_MWTbQFaYo_tw0O2WIWA1mzLNb8ZhyvjdEXcs/edit?usp=sharing",sheet = "Luis Barrios",
col_types = "Dcccccc")
View(luis_barrios)
library(googlesheets4)
library(dplyr)
library(lubridate)
library(tidyr)
library(tidyr)
library(gmailr)
# sending the sheet by gmailr
gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>% gm_text_body("Prueba de envío de correo automático")
# sending the sheet by gmailr
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>% gm_text_body("Prueba de envío de correo automático")
gm_send_message(mensaje)
gm_send_message(mensaje,user_id = "me")
gm_auth_configure()
gm_oauth_app()
gm_create_draft(mensaje)
gm_auth_configure()
gm_auth_configure(key = "299160033159-pk4ik6pfnb971sk5l9daavdmttqja27s.apps.googleusercontent.com",secret = "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")
gm_auth_configure(key = "299160033159-pk4ik6pfnb971sk5l9daavdmttqja27s.apps.googleusercontent.com",secret = "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")
autentication<-gm_auth_configure(key = "299160033159-pk4ik6pfnb971sk5l9daavdmttqja27s.apps.googleusercontent.com",secret = "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")
View(autentication)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body("Prueba de envío de correo automático")
# sending the message by gmailr
gm_send_message(mensaje,user_id = "me")
# sending the message by gmailr
gm_create_draft(mensaje)
View(luis_barrios)
View(luis_barrios)
# creating the message by gmailr
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body("Prueba de envío de correo automático \n ra")
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
View(luis_barrios)
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(luis_barrios)
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
View(luis_barrios)
luis_barrios$`Fecha de acompañamiento`
luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body( luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] )
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
View(luis_barrios)
luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)]
luis_barrios
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(
paste0(
"Fecha de acompañamiento: ", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Realizó el acompañamiento: ", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(
paste0(
"Fecha de acompañamiento: ", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Realizó el acompañamiento: ", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"A mejorar: ", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n",
"Plan de acción: ", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n",
"Plazo: ", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n",
"Observaciones: ", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(
paste0(
"Fecha de acompañamiento: ", "\n", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Realizó el acompañamiento: ", "\n", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\n", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(
paste0(
"Fecha de acompañamiento: ", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Realizó el acompañamiento: ", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\n", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(
paste0(
"Fecha de acompañamiento: ", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Realizó el acompañamiento: ", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", "\t", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", "\t", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n",
"Plan de acción: ", "\n", "\t", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\n", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n",
"Observaciones: ", "\n", "\t", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(
paste0(
"Fecha de acompañamiento: ", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Realizó el acompañamiento: ", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", "\t", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", "\t", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n",
"Plan de acción: ", "\n", "\t", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n",
"Observaciones: ", "\n", "\t", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(
paste0(
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(
paste0(
"__Fecha de acompañamiento__: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"__Realizó el acompañamiento__: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"__Plazo__: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(
paste0(
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject("Planes de acción") %>% gm_text_body(
paste0(
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
sheet_names("https://docs.google.com/spreadsheets/d/1QNXBhd_MWTbQFaYo_tw0O2WIWA1mzLNb8ZhyvjdEXcs/edit?usp=sharing")
sheet_names("https://docs.google.com/spreadsheets/d/1QNXBhd_MWTbQFaYo_tw0O2WIWA1mzLNb8ZhyvjdEXcs/edit?usp=sharing")[2]
nombres_hojas<-sheet_names("https://docs.google.com/spreadsheets/d/1QNXBhd_MWTbQFaYo_tw0O2WIWA1mzLNb8ZhyvjdEXcs/edit?usp=sharing")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
nombres_hojas[2]
View(mensaje)
nombres_hojas[2]
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Hola ",nombres_hojas[2]," !","\n",
"Te envío el resumen del acompañamiento realizado el día de hoy","\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Hola ",nombres_hojas[2]," !","\n",
"Te envío el resumen del acompañamiento realizado el día de hoy","\n","\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Hola ",nombres_hojas[2]," !","\n",
"Te envío el resumen del acompañamiento realizado el día de hoy junto a",luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)],"\n","\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
# creating the message by gmailr     \n <- es un salto de página
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Hola ",nombres_hojas[2]," !","\n",
"Te envío el resumen del acompañamiento realizado el día de hoy junto a ",luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)],"\n","\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
# sending the message by gmailr
#gm_create_draft(mensaje)
gm_send_message(mensaje,user_id = "me")
View(luis_barrios)
luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]=today()
luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]
View(luis_barrios)
luis_barrios<-range_read("https://docs.google.com/spreadsheets/d/1QNXBhd_MWTbQFaYo_tw0O2WIWA1mzLNb8ZhyvjdEXcs/edit?usp=sharing",sheet = nombres_hojas[2],
col_types = "Dcccccc")
1
View(luis_barrios)
today()
today()-1
today()
luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]=today()
luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today()
ifelse(luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today(), "SI","NO")
ifelse(luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today(), /*ASD*/ "SI","NO")
luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today()
ifelse(luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today()-1,
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Hola ",nombres_hojas[2]," !","\n",
"Te envío el resumen del acompañamiento realizado el día de hoy junto a ",luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)],"\n","\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
,"NO OCURRE NADA")
rm(luis_barrios)
rm(mensaje)
ifelse(luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today()-1,
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Hola ",nombres_hojas[2]," !","\n",
"Te envío el resumen del acompañamiento realizado el día de hoy junto a ",luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)],"\n","\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
,"")
luis_barrios<-range_read("https://docs.google.com/spreadsheets/d/1QNXBhd_MWTbQFaYo_tw0O2WIWA1mzLNb8ZhyvjdEXcs/edit?usp=sharing",sheet = nombres_hojas[2],
col_types = "Dcccccc")
1
ifelse(luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today()-1,
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Hola ",nombres_hojas[2]," !","\n",
"Te envío el resumen del acompañamiento realizado el día de hoy junto a ",luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)],"\n","\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
,"")
ifelse(luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today()-1,
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Hola ",nombres_hojas[2]," !","\n",
"Te envío el resumen del acompañamiento realizado el día de hoy junto a ",luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)],"\n","\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
,"")
ifelse(luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today(),
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Hola ",nombres_hojas[2]," !","\n",
"Te envío el resumen del acompañamiento realizado el día de hoy junto a ",luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)],"\n","\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
,"")
luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today()
luis_barrios<-range_read("https://docs.google.com/spreadsheets/d/1QNXBhd_MWTbQFaYo_tw0O2WIWA1mzLNb8ZhyvjdEXcs/edit?usp=sharing",sheet = nombres_hojas[2],
col_types = "Dcccccc")
ifelse(luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)]==today(),
mensaje<-gm_mime() %>% gm_to("luis.barrios@aflore.co") %>% gm_from("luis.barrios@aflore.co") %>%
gm_subject(paste0("Plan de acción acompañamiento de ", nombres_hojas[2]   )) %>% gm_text_body(
paste0(
"Hola ",nombres_hojas[2]," !","\n",
"Te envío el resumen del acompañamiento realizado el día de hoy junto a ",luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)],"\n","\n",
"Realizó el acompañamiento: ","\t", luis_barrios$`Realiza el acompañamiento`[nrow(luis_barrios)] ,"\n",
"Fecha de acompañamiento: ","\t", luis_barrios$`Fecha de acompañamiento`[nrow(luis_barrios)] ,"\n",
"Plazo: ", "\t", luis_barrios$Plazo[nrow(luis_barrios)] ,"\n", "\n",
"A mejorar: ", "\n", luis_barrios$`A mejorar`[nrow(luis_barrios)] ,"\n","\n",
"Aspectos donde se evidencia avance vs acompañamientos anteriores: ", "\n", luis_barrios$`Aspectos donde se evidencia avance vs acompañamientos anteriores`[nrow(luis_barrios)] ,"\n","\n",
"Plan de acción: ", "\n", luis_barrios$`Plan de acción`[nrow(luis_barrios)] ,"\n","\n",
"Observaciones: ", "\n", luis_barrios$Observaciones[nrow(luis_barrios)] ,"\n"
))
,"")
gm_send_message(mensaje,user_id = "me")
nrow(nombres_hojas)
length(nombres_hojas)
rm(luis_barrios)
data<-range_read("https://docs.google.com/spreadsheets/d/1QNXBhd_MWTbQFaYo_tw0O2WIWA1mzLNb8ZhyvjdEXcs/edit?usp=sharing",sheet = nombres_hojas[1],
col_types = "Dcccccc")
correos<-c("luisa.moreno@aflore.co","leidy.rojas@aflore.co","andresmauricio@aflore.co","nelson.rubio@aflore.co",
"jhiovanni.vivas@aflore.co","tatiana.real@aflore.co","camilo.escobedo@aflore.co","catalina.suarez@aflore.co",
"esmeralda@aflore.co","jose.alvarez@aflore.co","karen.fernandez@aflore.co")
correos
# reading C-SAT data from googlesheets
# install.packages("googlesheets4")
library(googlesheets4)
library(dplyr)
library(lubridate)
library(tidyr)
# tal parece que los nombres de los sheets no pueden contener tildes o falla la lectura mediante gs4
# name_of_sheets<-sheet_names("https://docs.google.com/spreadsheets/d/12VXX9J2UixC3IWMwmwzoGXgRCWl8KoONXS2t_bEqeEM/edit?usp=sharing")
nelson_rubio<-range_read("https://docs.google.com/spreadsheets/d/12VXX9J2UixC3IWMwmwzoGXgRCWl8KoONXS2t_bEqeEM/edit?usp=sharing",sheet = "Nelson Rubio",
col_types = "Dnccc")
luz_dary_useche<-range_read("https://docs.google.com/spreadsheets/d/12VXX9J2UixC3IWMwmwzoGXgRCWl8KoONXS2t_bEqeEM/edit?usp=sharing",sheet = "Luz Dary Useche",
col_types = "Dnccc")
jose_luis_alvarez<-range_read("https://docs.google.com/spreadsheets/d/12VXX9J2UixC3IWMwmwzoGXgRCWl8KoONXS2t_bEqeEM/edit?usp=sharing",sheet = "Jose Luis Alvarez",
col_types = "Dnccc")
camilo_escobedo<-range_read("https://docs.google.com/spreadsheets/d/12VXX9J2UixC3IWMwmwzoGXgRCWl8KoONXS2t_bEqeEM/edit?usp=sharing",sheet = "Camilo Escobedo",
col_types = "Dnccc")
tatiana_real<-range_read("https://docs.google.com/spreadsheets/d/12VXX9J2UixC3IWMwmwzoGXgRCWl8KoONXS2t_bEqeEM/edit?usp=sharing",sheet = "Tatiana Real",
col_types = "Dnccc")
luisa_moreno<-range_read("https://docs.google.com/spreadsheets/d/12VXX9J2UixC3IWMwmwzoGXgRCWl8KoONXS2t_bEqeEM/edit?usp=sharing",sheet = "Luisa Moreno",
col_types = "Dnccc")
leidy_rojas<-range_read("https://docs.google.com/spreadsheets/d/12VXX9J2UixC3IWMwmwzoGXgRCWl8KoONXS2t_bEqeEM/edit?usp=sharing",sheet = "Leidy Rojas",
col_types = "Dnccc")
karen_fernandez<-range_read("https://docs.google.com/spreadsheets/d/12VXX9J2UixC3IWMwmwzoGXgRCWl8KoONXS2t_bEqeEM/edit?usp=sharing",sheet = "Karen Fernandez",
col_types = "Dnccc")
catalina_suarez<-range_read("https://docs.google.com/spreadsheets/d/12VXX9J2UixC3IWMwmwzoGXgRCWl8KoONXS2t_bEqeEM/edit?usp=sharing",sheet = "Catalina Suarez",
col_types = "Dnccc")
# homogenizando los nombres de las columnas
colnames(luz_dary_useche)<-colnames(nelson_rubio)
colnames(jose_luis_alvarez)<-colnames(nelson_rubio)
colnames(camilo_escobedo)<-colnames(nelson_rubio)
colnames(tatiana_real)<-colnames(nelson_rubio)
colnames(luisa_moreno)<-colnames(nelson_rubio)
colnames(leidy_rojas)<-colnames(nelson_rubio)
colnames(karen_fernandez)<-colnames(nelson_rubio)
colnames(catalina_suarez)<-colnames(nelson_rubio)
# creando columna nombre
nelson_rubio<-nelson_rubio %>% mutate(nombre= 'Nelson Rubio')
luz_dary_useche<-luz_dary_useche %>% mutate(nombre='Luz Dary Useche')
jose_luis_alvarez<-jose_luis_alvarez %>% mutate(nombre='Jose Luis Alvarez')
camilo_escobedo<-camilo_escobedo %>% mutate(nombre='Camilo Escobedo')
tatiana_real<-tatiana_real %>% mutate(nombre='Tatiana Real')
luisa_moreno<-luisa_moreno %>% mutate(nombre='Luisa Moreno')
leidy_rojas<-leidy_rojas %>% mutate(nombre='Leidy Rojas')
karen_fernandez<-karen_fernandez %>% mutate(nombre='Karen Fernandez')
catalina_suarez<-catalina_suarez %>% mutate(nombre='Catalina Suarez')
# ultimos 7 dias
last_7_days<-bind_rows(
nelson_rubio %>% filter(Timestamp>(today()-8)) ,
luz_dary_useche %>% filter(Timestamp>(today()-8)) ,
jose_luis_alvarez %>% filter(Timestamp>(today()-8)) ,
camilo_escobedo %>% filter(Timestamp>(today()-8)) ,
tatiana_real %>% filter(Timestamp>(today()-8)) ,
luisa_moreno %>% filter(Timestamp>(today()-8)) ,
leidy_rojas %>% filter(Timestamp>(today()-8)) ,
karen_fernandez %>% filter(Timestamp>(today()-8)) ,
catalina_suarez %>% filter(Timestamp>(today()-8))
)
selected_data<-last_7_days %>%
drop_na(`Si quieres que te contactemos para profundizar sobre tu calificación, ¡déjanos tu número de celular porfa! (Opcional) - Sin espacios, sin símbolos ni +57`) %>%
arrange(across(Timestamp,desc))
#ss <- gs4_create("wish_contact_last_7_days", sheets = selected_data)
sheet_write(selected_data,ss="https://docs.google.com/spreadsheets/d/1CNdsejB5HRBYDAj6pajzfpjE60_BBSf2uA_KRWAkJPc/edit?usp=sharing",sheet="selected_data")
rm(list=ls())
